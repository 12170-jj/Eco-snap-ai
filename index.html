<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Eco Snap AI</title>

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>

<style>
body {
  margin:0;
  font-family:sans-serif;
  background:linear-gradient(#0f3d2e,#1e7f5c);
  color:white;
  text-align:center;
}
.card{
  background:#134e3a;
  margin:15px;
  padding:20px;
  border-radius:20px;
}
button{
  background:#1eff9c;
  border:none;
  padding:15px 25px;
  border-radius:30px;
  font-size:18px;
}
img{max-width:90%;border-radius:15px;margin-top:10px}
</style>
</head>

<body>

<h1>üå± Eco Snap AI</h1>
<p>‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏Ç‡∏¢‡∏∞ ‚Üí ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå ‚Üí ‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</p>

<div class="card">
üì∏ <b>‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏Ç‡∏¢‡∏∞</b><br><br>
<input type="file" accept="image/*" capture="environment" id="imageInput">
<img id="preview">
</div>

<div class="card">
üß† <b>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</b>
<div id="result">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</div>
</div>

<div class="card">
‚≠ê <b>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏∞‡∏™‡∏°</b>
<div id="score">0</div>
</div>

<div class="card">
üìú <b>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</b>
<ul id="history"></ul>
</div>

<script>
const URL = "‡πÉ‡∏™‡πà‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ/"; // üëà ‡πÅ‡∏Å‡πâ‡πÅ‡∏Ñ‡πà‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ

let model;
let score = 0;

async function loadModel(){
  model = await tmImage.load(URL + "model.json", URL + "metadata.json");
}
loadModel();

document.getElementById("imageInput").addEventListener("change", async (e)=>{
  const file = e.target.files[0];
  if(!file) return;

  const img = document.getElementById("preview");
  img.src = URL.createObjectURL(file);

  img.onload = async ()=>{
    const prediction = await model.predict(img);
    prediction.sort((a,b)=>b.probability-a.probability);

    const best = prediction[0];
    document.getElementById("result").innerText =
      best.className + " (" + (best.probability*100).toFixed(1) + "%)";

    score += 10;
    document.getElementById("score").innerText = score;

    const li = document.createElement("li");
    li.innerText = best.className;
    document.getElementById("history").appendChild(li);
  }
});
</script>

</body>
</html>
