<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Eco Snap AI</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest"></script>

<style>
body{margin:0;font-family:sans-serif;background:#d1fae5}
.page{display:none;padding:20px}
.page.active{display:block}
button{padding:15px;width:100%;border:none;border-radius:30px;font-size:18px;margin-top:10px}
.green{background:#22c55e}
.card{background:#ecfdf5;padding:20px;border-radius:20px;margin-top:15px}
img{max-width:100%;border-radius:15px}
</style>
</head>

<body>

<!-- PAGE 1 -->
<div id="role" class="page active">
  <h2>üå± Eco Snap AI</h2>
  <button class="green" onclick="showPage('student')">‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
  <button class="green" onclick="showPage('teacher')">‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏π</button>
</div>

<!-- PAGE 2 -->
<div id="student" class="page">
  <h3>‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
  <input type="file" id="imgInput" accept="image/*">
  <img id="preview">
  <button class="green" onclick="analyze()">üß† ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</button>
  <div id="result"></div>
  <button onclick="showPage('role')">‚¨Ö ‡∏Å‡∏•‡∏±‡∏ö</button>
</div>

<!-- PAGE 3 -->
<div id="teacher" class="page">
  <h3>‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏π</h3>
  <p>‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ï‡πà‡∏≠‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á</p>
  <button onclick="showPage('role')">‚¨Ö ‡∏Å‡∏•‡∏±‡∏ö</button>
</div>

<script>
function showPage(id){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

/* AI */
const URL="https://teachablemachine.withgoogle.com/models/UQwja1MPO/";
let model;

imgInput.onchange=e=>{
  const r=new FileReader();
  r.onload=()=>preview.src=r.result;
  r.readAsDataURL(e.target.files[0]);
};

async function analyze(){
  if(!model){
    model=await tmImage.load(URL+"model.json",URL+"metadata.json");
  }
  const p=await model.predict(preview);
  p.sort((a,b)=>b.probability-a.probability);
  result.innerText=`${p[0].className} ${(p[0].probability*100).toFixed(1)}%`;
}
</script>

</body>
</html>
