<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Eco Snap AI</title>

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest"></script>

<style>
body{
    margin:0;
    font-family:sans-serif;
    background:#0f5132;
    color:white;
}
header{
    padding:20px;
    text-align:center;
    font-size:28px;
    font-weight:bold;
}
.score{
    position:fixed;
    top:10px;
    right:15px;
    background:#198754;
    padding:8px 14px;
    border-radius:20px;
    font-weight:bold;
}
.container{
    padding:20px;
}
.card{
    background:#145c3a;
    border-radius:20px;
    padding:20px;
    margin-bottom:20px;
}
#preview{
    width:100%;
    height:250px;
    background:#0b3d28;
    border-radius:15px;
    display:flex;
    align-items:center;
    justify-content:center;
    overflow:hidden;
}
#preview img{
    max-width:100%;
    max-height:100%;
}
button{
    width:100%;
    padding:15px;
    border:none;
    border-radius:30px;
    font-size:18px;
    margin-top:10px;
    cursor:pointer;
}
.analyze{ background:#2dff9a; }
.done{ background:#00c853; color:white; }

.result{
    background:white;
    color:#000;
    border-radius:15px;
    padding:15px;
    font-size:18px;
}

.history-btn{
    background:#198754;
    color:white;
}
</style>
</head>

<body>

<div class="score">‚≠ê 0</div>

<header>üå± Eco Snap AI</header>

<div class="container">

<div class="card">
    <div id="preview">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ</div>
    <input type="file" accept="image/*" onchange="loadImage(event)">
</div>

<button class="analyze" onclick="analyze()">üß† ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</button>
<button class="done" onclick="finish()">‚úÖ ‡πÅ‡∏¢‡∏Å‡∏Ç‡∏¢‡∏∞‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß</button>

<div class="card">
    <h3>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</h3>
    <div id="result" class="result">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</div>
</div>

<button class="history-btn">üìú ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</button>

</div>

<script>
const URL = "https://teachablemachine.withgoogle.com/models/UQwja1MPO/";
let model;
let imageElement;
let score = 0;

async function loadModel(){
    model = await tmImage.load(URL+"model.json", URL+"metadata.json");
}
loadModel();

function loadImage(event){
    const img = document.createElement("img");
    img.src = URL.createObjectURL(event.target.files[0]);
    imageElement = img;
    const preview = document.getElementById("preview");
    preview.innerHTML="";
    preview.appendChild(img);
}

async function analyze(){
    if(!imageElement){
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏Å‡πà‡∏≠‡∏ô");
        return;
    }
    const prediction = await model.predict(imageElement);
    prediction.sort((a,b)=>b.probability-a.probability);

    document.getElementById("result").innerHTML =
        "üóëÔ∏è ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏¢‡∏∞: <b>"+prediction[0].className+"</b><br>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à: "+
        (prediction[0].probability*100).toFixed(1)+"%";
}

function finish(){
    score+=10;
    document.querySelector(".score").innerText = "‚≠ê "+score;
    alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à +10 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô");
}
</script>

</body>
</html>
